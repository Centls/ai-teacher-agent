# Nexus — AI 多老师智能体系统（Web SaaS）

## 最终版 PRD（Pure Product Document，Web-only）

---

## 0. 文档定位与适用范围（重要说明）

* 本文档为**纯产品需求说明**（PRD），**不包含代码实现**。
* 交付形态限定为**网页工作台（Web Workbench） + 后端 API**，**不做移动 App**或原生客户端。
* 面向对象：小微商家 / 内容创作者（To-Small-B）；实现目标为“网页上完成从表单到生成再到编辑的一体化工作流”。

---

## 1. 产品愿景与核心目标

**愿景**：让每位小微商家与创作者，通过网页界面，拥有一支“可信赖的 AI 虚拟员工队伍”，以最低成本完成专业任务（写文案、练话术、做客服、做分析、进行演练、陪聊）。

**核心目标（长期）**：

1. 通过“Manifest（老师配置）+ 私有知识库”快速派生新老师；
2. 在网页端以表单/模板驱动的方式，使非技术用户可立即产出可用内容；
3. 保证可控性：边界、审计、HITL 与成本治理内建。

**阶段目标（Phase 1）**：

* Web 工作台上线（营销老师首发）；
* Manifest 驱动前端表单与输出展示；
* Prompt 管理、Quota、Audit、会话切换与 Envelope 协议到位。
* Phase 1 的唯一对外产品角色为：营销老师（Marketing Teacher）。
* 其余 Teacher 为已验证可复用能力，不作为 Phase 1 的产品交付目标。
---

## 2. 核心用户与使用场景

**核心用户**：小红书/抖音博主、微商/私域运营、小团队老板、内容创作者。
**典型场景**：

* 生成一篇小红书文章（营销老师，表单填充 → 生成 → 编辑 → 导出）；
* 练习销售话术（演练老师，语音/文字交互 → 得到评分与改进建议）；
* 客服回答（客服老师，粘贴用户问题 → 返回标准化回复）。

---

## 3. 产品形态（仅 Web）

**Nexus Core（后端）**：RESTful API，包含 Supervisor、Teacher 调度、Prompt 管理、Quota、RAG（namespace 限定）、Audit、Session 管理、HITL 流程等。
**Nexus Web Workbench（前端）**：单一网页应用，功能块包括：员工大厅、任务表单（Schema-driven）、结果编辑器、知识库管理、账户页、运营/审计页（管理员视角）。
**Nexus Admin Console（Web 内置）**：Prompt 管理、Manifest 编辑、HITL 队列、配额设置与日志审计。

---

## 4. 关键产品概念与契约（无代码说明）

### 4.1 Teacher（AI 老师）

* 定义：面向特定业务目标的独立虚拟员工（例如：营销老师、演练老师等）。
* 以 Manifest 进行产品化定义（下列为 Manifest 的必含要素，使用文档化字段描述）：

  * 名称、版本、简介、展示头像/人设
  * Persona：语气、风格、禁止事项
  * Knowledge Namespace：所绑定的知识库标识（私有/共享）
  * Skills：允许调用的工具或能力（如 web_search、calculator）
  * Input Schema：前端表单渲染用的结构化字段说明（字段名、类型、是否必填、选项/枚举、提示文案）
  * Output Schema：规范化的输出结构说明（用于前端渲染或二次处理）
  * Boundary / Refusal Rules：明确禁止输出的内容类型或话术（如医疗/法律）
  * HITL 配置：是否默认开启、触发条件（如敏感词、首次发布）
  * Quota 权重：用于计费/限流的资源权重说明

### 4.2 Manifest 驱动前端

* 前端通过读取 Teacher 的 Input Schema 自动生成“任务表单”；表单提交数据作为 Teacher 的请求参数输入后端。

### 4.3 Envelope（统一响应信封，描述式）

* 每次生成的后端响应必须包含描述性元数据（request_id、session_id、teacher、manifest_version、timestamp）、状态（SUCCESS / REFUSAL / FALLBACK / PENDING_HITL）、payload（content_type 指示：application/json / text/markdown / stream、主体遵守 Output Schema）与诊断信息（token_usage、rag_hits、model_version）。
* 前端以 Envelope 为唯一解析入口：无须根据 Teacher 类型进行不同解析逻辑（根据 content_type 渲染）。

### 4.4 Session 与会话切换（策略说明）

* Session 管理为网页用户关于当前工作任务的容器。
* 会话切换三策略（可配置）：

  * Preserve（保留）——在主题相关切换中保留 short-term memory；
  * Summarize（汇总）——跨主题时自动生成旧上下文摘要传入新任务；
  * Drop（丢弃）——彻底隔离。
* 默认行为：自动模式（Supervisor）在判断为“主题相近”时采用 Preserve，否则 Summarize。用户可在 UI 指定“保留上下文”或“新话题开始”。

### 4.5 Access Modes（接入模式）

* Supervisor Mode（自动）：用户在统一入口输入需求，系统识别意图并路由；
* Direct Mode（指定）：用户点击某位老师的卡片进入指定流程，绕过意图识别（常见于工作台按钮）。

### 4.6 HITL（人类介入）

* 在 Manifest 中声明哪些 Teacher 默认开启 HITL 与触发条件；管理员可在 Console 配置审批人。
* HITL 流程包含：任务进入待审队列、人工审阅（修改/批准/拒绝）、人工结果回写到系统并被记录为高价值样本（隐式反馈）。

### 4.7 Quota / 资源治理（商业约束）

* Global cap（每日/月度组织级消费上限）；达到阈值触发系统熔断并通知管理员。
* User quota（免费/付费等级、免费次数/天等）；Quota 扣减策略以 Manifest 的 quota 权重为计量单位。
* Teacher-level rate limit：对高成本 Teacher（多模态/数字人）设定独立限制。

### 4.8 Feedback & Evolution（进化闭环）

* 显式反馈：用户可对结果点赞/踩并提交改进建议（绑定 manifest_version 与 session）。
* 隐式反馈：HITL 的人工修改记录为优质样本。
* 所有反馈被标注并存档（需用户授权后供后续人工/自动化 Prompt 优化或模型微调）。

---

## 5. 老师业务矩阵（精炼表述）

（每一项为产品级说明，便于产品/运营理解，不含实现细节）

* **营销老师**：主场景为文案生成（多风格、多版本），表单输入：产品名、核心卖点、目标受众、风格选择；输出为多条 Markdown 风格排版文案，带推荐标签与 Emoji 排列建议。HITL：可选（首次发布或检测到敏感词）。Quota 权重：低-中。
* **演练老师**：场景为角色扮演/话术训练，输入支持语音或文本；输出为评分、建议和示例回复。HITL：可选/默认开启（高影响场景）。Quota 权重：中。
* **客服老师**：场景为标准问答与知识检索，必须严格遵守拒答策略；输出为结构化 JSON（answer + source + confidence）。HITL：否（除特殊情况）。Quota 权重：低。
* **分析老师**：场景为上传数据或文本后的结构化分析、建议与摘要；输出 JSON/报告格式，可能伴随图表下载链接。HITL：可选。Quota 权重：中-高（视数据处理复杂度）。
* **数字人直播老师**：场景为实时口播脚本生成（带时间戳）、弹幕应答建议；对延时敏感，默认需低延时策略，HITL：可选（运营审核）。Quota 权重：高。
* **陪聊老师**：场景为长期交互、情感陪护与人设一致性；必须实施长期记忆策略与隐私保护。HITL：可选。Quota 权重：可调。

---

## 6. 前端（Web）体验设计要点（产品规范，不含实现）

1. **员工大厅**：卡片式展示所有可用 Teachers，卡片展示人设、示例、点击进入“任务表单”。
2. **Schema-Driven 表单**：表单由后端 Manifest 的 Input Schema 驱动生成；字段带说明与示例。
3. **生成视图**：提交后立即进入“生成中”流式视图（若支持流式输出）；生成完成后展示 Envelope 中的 payload。
4. **结果编辑器**：富文本/Markdown 编辑器，支持一键复制、再生成（换一种说法）、记录版本历史。
5. **会话管理面板**：可查看当前 Session、短期上下文、会话切换策略设置（保留/汇总/丢弃）。
6. **Quota 提示**：在用户操作前后，明显展示剩余配额与计费信息；在达到上限时提供升级或购买入口。
7. **HITL 队列（管理员）**：显示待审批任务，支持快速修改/通过/拒绝，并能将人工修改回写为改进样本。
8. **知识库管理**：用户可上传文档并标注为私有知识库；上传后在调用时可选择是否“引用我的知识库”。

---

## 7. 数据治理与隐私（产品约束）

* 私有知识库按 user_id 或 org_id 进行 namespace 隔离；前端/后端在检索时强制带 namespace。
* PII（姓名、电话、身份证等）检测与脱敏默认开启；用户可在设置中管理数据保留期。
* 数据用于优化（如训练或 Prompt 改进）需要用户显式授权。

---

## 8. 关键指标（Product KPIs）

* 产品可用性：用户从进入页面到拿到第一版文案 ≤ 60 秒。
* 路由准确率（Supervisor） ≥ 95%（自动模式）。
* 新老师配置到上线（通过 Manifest 且无需改后端） ≤ 30 分钟。
* 月留存率（M1）目标 ≥ 30%。
* 平均首字延迟（流式） < 3 秒（体验目标）。

---

## 9. 验收标准（Phase 1）

必须满足以下条件方视为 Phase 1 验收通过（均为产品级验收，不涉及代码实现细节）：

1. Web 工作台能够展示员工大厅，基于 Manifest 自动渲染任务表单并提交生成请求。
2. 系统在 Direct Mode（用户指定 Teacher）与 Supervisor Mode（自动路由）两种模式下均能正常交付生成结果，并返回符合 Envelope 要求的响应。
3. 会话切换默认策略（自动判断并 Summarize）生效，用户可手动选择保留/丢弃。
4. Quota 与 Gatekeeper 在用户交互前后能正确显示配额状态并阻止超额请求。
5. Admin Console 能查看并处理 HITL 队列与审计日志（可展示但无须完整审批权限管理实现）。
6. Prompt 管理能够在线加载/更新教师的 prompt（为 Phase 1 可为简化版本，支持热加载与回滚操作说明）。
7. Audit 日志记录每次生成请求的关键元数据（request_id、teacher、token_usage、status）并可导出审计记录。

---

## 10. 路线图（产品节奏建议）

* **Phase 1（0–2 个月）**：Web 工具（Marketing Teacher）、Manifest 驱动表单、Quota、Envelope、Audit、简单 Supervisor（Fake intent mapping 可接受）。
* **Phase 2（2–4 个月）**：添加 HITL 队列、用户私有知识库上传、更多 Teachers（客服、演练）、完善 Summarize 策略。
* **Phase 3（4–8 个月）**：多模态支持（图片输入 / 概要化输出）、数字人直播能力原型、商业化扩展（多层付费计划）。

---

## 11. 下一步交付与产出（建议性的产品交付清单）

（作为产品经理给工程/设计/运营的任务拆解起点）

1. 输出标准化 Manifest 模板与填写说明（文档）。
2. 定义前端表单组件库映射（字段类型 → 控件类型 & 校验规则）与 UI 文案模板。
3. 制定 Envelope 规范文档（字段解释、错误码、HITL 流程的状态流）。
4. 设计 Quota 与计费策略草案（Free/Pro/Enterprise 简表）。
5. 制定 Audit 导出与保留策略（JSONL / CSV 格式说明、保留期）。
6. 研发与测试：Phase 1 的验收清单转化为开发任务并执行验收测试。

---

