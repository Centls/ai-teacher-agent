# ğŸ“‹ AI Teacher Nexus - å·²å®ç°åŠŸèƒ½è¯¦ç»†æ¸…å•

## ğŸ¯ æ ¸å¿ƒæ¶æ„

### 1. LangGraph å·¥ä½œæµå¼•æ“
- âœ… **CRAG (Corrective RAG) å®Œæ•´å®ç°**
  - æ£€ç´¢ â†’ ç›¸å…³æ€§è¯„åˆ† â†’ ç”Ÿæˆ â†’ å¹»è§‰æ£€æµ‹ â†’ è´¨é‡è¯„ä¼°
  - è‡ªåŠ¨æŸ¥è¯¢é‡å†™ (Query Rewriting) å½“æ–‡æ¡£ä¸ç›¸å…³æ—¶
  - æœ€å¤§é‡è¯•é™åˆ¶ (`max_retries=3`) é˜²æ­¢æ— é™å¾ªç¯
  - Fallback æ¨¡å¼ï¼šæ— ç›¸å…³æ–‡æ¡£æ—¶æä¾›é€šç”¨å›ç­”
- âœ… **HITL (Human-in-the-Loop) äººæœºäº¤äº’**
  - ä½¿ç”¨ `interrupt()` åœ¨ç”Ÿæˆå‰è¯·æ±‚äººå·¥å®¡æ ¸
  - ä¼ é€’å®¡æ ¸ä¸Šä¸‹æ–‡ (é—®é¢˜ + æ£€ç´¢æ–‡æ¡£é¢„è§ˆ)
  - æ”¯æŒ Allow/Deny ä¸¤ç§å®¡æ ¸ç»“æœ
  - Deny åè‡ªåŠ¨ç¦ç”¨ HITL å¹¶é‡æ–°æ£€ç´¢ (é¿å…æ— é™ä¸­æ–­)
  - æ¡ä»¶è·¯ç”±ï¼š`"generate": "human_approval" if with_hitl else "generate"`
- âœ… **çŠ¶æ€æŒä¹…åŒ– (Checkpoint)**
  - `AsyncSqliteSaver` è‡ªåŠ¨ä¿å­˜å¯¹è¯çŠ¶æ€åˆ° `checkpoints.sqlite`
  - æ”¯æŒè·¨ä¼šè¯æ¢å¤å¯¹è¯å†å²
  - ä½¿ç”¨ `from_conn_string()` æ­£ç¡®ç®¡ç†è¿æ¥ç”Ÿå‘½å‘¨æœŸ
- âœ… **é•¿æœŸè®°å¿† (Long-term Memory)**
  - è‡ªå®šä¹‰ `AsyncSQLiteStore` å®ç° `BaseStore` æ¥å£
  - æŒä¹…åŒ–ç”¨æˆ·åå¥½è§„åˆ™åˆ° `data/user_preferences.db`
  - æ”¯æŒ `aget`, `aput`, `adelete`, `asearch`, `abatch` æ“ä½œ
  - ä½¿ç”¨ namespace éš”ç¦»ä¸åŒç±»å‹çš„è®°å¿† (å¦‚ `marketing_preferences`)

## ğŸ§  AI Agent èƒ½åŠ›

### 2. Marketing Teacher Agent (è¥é”€è€å¸ˆ)
- âœ… **çŸ¥è¯†æ£€ç´¢ä¸ç”Ÿæˆ**
  - åŸºäºæ£€ç´¢åˆ°çš„æ–‡æ¡£ç”Ÿæˆ 200-300 è¯è¥é”€å»ºè®®
  - Markdown æ ¼å¼è¾“å‡º (æ ‡é¢˜ã€åŠ ç²—ã€åˆ—è¡¨ã€å¼•ç”¨)
  - è‡ªåŠ¨æ·»åŠ æ–‡æ¡£æ¥æºå¼•ç”¨ `[Source 1] (File: xxx)`
  - æ”¯æŒå¤šæŸ¥è¯¢æ£€ç´¢ (Query Expansion)
- âœ… **Reflection å­¦ä¹ æœºåˆ¶**
  - `learning_node`: åˆ†æå¯¹è¯å†å²,æå–ç”¨æˆ·åå¥½
  - ä½¿ç”¨ LLM ç”Ÿæˆä¸ªæ€§åŒ–è§„åˆ™ (å¦‚"ç®€æ´å›ç­”"ã€"ä½¿ç”¨æ¡ˆä¾‹")
  - è§„åˆ™æŒä¹…åŒ–åˆ° Store,è·¨ä¼šè¯ç”Ÿæ•ˆ
  - åœ¨ç”Ÿæˆæ—¶åŠ¨æ€æ³¨å…¥ç”¨æˆ·è§„åˆ™åˆ° Prompt
- âœ… **æ™ºèƒ½è·¯ç”±å™¨**
  - `should_generate`: åˆ¤æ–­æ–‡æ¡£ç›¸å…³æ€§,å†³å®šç”Ÿæˆæˆ–é‡å†™æŸ¥è¯¢
  - `check_hallucination_router`: æ£€æµ‹å¹»è§‰å¹¶å†³å®šç»“æŸ/é‡è¯•
  - `check_approval`: æ ¹æ®äººå·¥å®¡æ ¸ç»“æœè·¯ç”±åˆ°ç”Ÿæˆæˆ–é‡è¯•
- âœ… **èŠ‚ç‚¹å®ç° (9ä¸ªæ ¸å¿ƒèŠ‚ç‚¹)**
  - `retrieve_node`: Hybrid Searchæ£€ç´¢
  - `grade_documents_node`: LLM è¯„ä¼°æ–‡æ¡£ç›¸å…³æ€§
  - `human_approval_node`: ä¸­æ–­å¹¶è¯·æ±‚å®¡æ ¸
  - `generate_node`: ç”Ÿæˆæœ€ç»ˆå›ç­” (æ”¯æŒFallback)
  - `transform_query_node`: æŸ¥è¯¢é‡å†™ä¸æ‹†è§£
  - `check_answer_quality`: å¹»è§‰æ£€æµ‹ + è´¨é‡è¯„ä¼°
  - `learning_node`: åæ€ä¸è§„åˆ™æ›´æ–°
  - 3ä¸ªè·¯ç”±å‡½æ•°: `should_generate`, `check_approval`, `check_hallucination_router`

### 3. Supervisor å¤šæ™ºèƒ½ä½“è°ƒåº¦
- âœ… **Nexus Supervisor 2.0**
  - ä½¿ç”¨ `langgraph_supervisor` åŒ…è‡ªåŠ¨è·¯ç”±
  - ç®¡ç† `MarketingTeacher` + `GeneralAssistant`
  - æ ¹æ®é—®é¢˜ç±»å‹æ™ºèƒ½åˆ†å‘ç»™ä¸“å®¶ Agent
  - æ”¯æŒ Handoff æœºåˆ¶ (Agent é—´åä½œ)
  - è¾“å‡ºæ¨¡å¼: `full_history` ä¿ç•™å®Œæ•´å¯¹è¯
- âœ… **General Assistant**
  - ç®€å•çš„é€šç”¨èŠå¤© Agent (å¤„ç†éè¥é”€é—®é¢˜)
  - å¤ç”¨ DeepSeek LLM é…ç½®
  - å•èŠ‚ç‚¹å›¾: `general_chat` â†’ END

## ğŸ“š RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ)

### 4. Hybrid Search æ··åˆæ£€ç´¢
- âœ… **å‘é‡æ£€ç´¢ (Semantic Search)**
  - ChromaDB ä½œä¸ºå‘é‡æ•°æ®åº“ (`collection_name=financial_docs`)
  - ä½¿ç”¨ OpenAI Compatible Embeddings (Aliyun text-embedding-v2)
  - æ”¯æŒå…ƒæ•°æ®è¿‡æ»¤ (Metadata Filtering)
- âœ… **BM25 å…³é”®è¯é‡æ’åº**
  - `rank_bm25` çš„ BM25Plus ç®—æ³•
  - æ ¹æ®å…³é”®è¯é‡æ–°æ’åºæ£€ç´¢ç»“æœ
  - æå– Markdown æ ‡é¢˜ä¸å†…å®¹å—è¿›è¡Œåˆ†æ®µè¯„åˆ†
  - Fetch k*5 å€™é€‰,é‡æ’åè¿”å› Top k
- âœ… **æ–‡æ¡£åŠ è½½å™¨ (6ç§æ ¼å¼)**
  - PDF: `PyPDFLoader`
  - DOCX: `UnstructuredWordDocumentLoader`
  - TXT: `TextLoader`
  - CSV: `CSVLoader`
  - XLSX: `UnstructuredExcelLoader`
  - Markdown: `TextLoader` + `MarkdownHeaderTextSplitter`
- âœ… **æ™ºèƒ½åˆ†å—ç­–ç•¥**
  - `auto`: æ ¹æ®æ–‡ä»¶ç±»å‹è‡ªåŠ¨é€‰æ‹©
  - `header`: MarkdownæŒ‰æ ‡é¢˜åˆ†å— (# ## ###)
  - `character`: é€’å½’å­—ç¬¦åˆ†å— (`chunk_size=1000`, `overlap=100`)
  - è‡ªåŠ¨ Fallback æœºåˆ¶

## ğŸ—„ï¸ çŸ¥è¯†åº“ç®¡ç†

### 5. æ–‡ä»¶ä¸Šä¼ ä¸ç®¡ç†
- âœ… **æ°¸ä¹…çŸ¥è¯†åº“ (/upload/knowledge)**
  - æ–‡ä»¶ä¿å­˜åˆ° `data/uploads/` å¹¶é‡å‘½åä¸º `{uuid}_{filename}`
  - å…ƒæ•°æ®å­˜å‚¨åˆ° SQLite (`data/knowledge.db`)
  - è‡ªåŠ¨å»ºç«‹å‘é‡ç´¢å¼• (ChromaDB)
  - è®°å½•ä¸Šä¼ æ—¶é—´ã€æ–‡ä»¶å¤§å°ã€çŠ¶æ€ (`indexed`)
- âœ… **ä¸´æ—¶é™„ä»¶ (/upload/attachment)**
  - ä¸æ±¡æŸ“æ°¸ä¹…çŸ¥è¯†åº“
  - è§£ææ–‡ä»¶å†…å®¹åç›´æ¥è¿”å›æ–‡æœ¬
  - æ–‡ä»¶ä¿å­˜åˆ° `tempfile.NamedTemporaryFile`
  - ä½¿ç”¨åè‡ªåŠ¨åˆ é™¤
- âœ… **æ–‡ä»¶åˆ—è¡¨ä¸åˆ é™¤**
  - `/knowledge/list`: åˆ—å‡ºæ‰€æœ‰æ–‡æ¡£ (æŒ‰æ—¶é—´å€’åº)
  - `/knowledge/{doc_id}`: åˆ é™¤æ–‡æ¡£
  - çº§è”åˆ é™¤: å‘é‡æ•°æ®åº“ + ç£ç›˜æ–‡ä»¶ + SQLiteè®°å½•
  - ä½¿ç”¨ `source_file` å…ƒæ•°æ®åŒ¹é…å¹¶åˆ é™¤æ‰€æœ‰ chunks

## ğŸ’¬ å¯¹è¯ç®¡ç†

### 6. Thread (ä¼šè¯) ç®¡ç†
- âœ… **SQLite çº¿ç¨‹æ•°æ®åº“ (threads.db)**
  - è¡¨ç»“æ„: `id`, `title`, `created_at`, `updated_at`
  - è‡ªåŠ¨ç”Ÿæˆæ ‡é¢˜: ä»é¦–æ¡æ¶ˆæ¯æˆªå–å‰50å­—ç¬¦
  - CRUD æ“ä½œ:
    - `GET /threads`: åˆ—å‡ºæ‰€æœ‰ä¼šè¯ (æŒ‰æ›´æ–°æ—¶é—´å€’åº)
    - `POST /threads`: åˆ›å»ºæ–°ä¼šè¯
    - `DELETE /threads`: åˆ é™¤ä¼šè¯
    - `PATCH /threads`: é‡å‘½åä¼šè¯
- âœ… **å†å²è®°å½•æ¢å¤**
  - `/history/{thread_id}`: ä» Checkpoint è¯»å–å†å²æ¶ˆæ¯
  - æ ¼å¼åŒ–ä¸ºå‰ç«¯ `MessageResponse` æ ¼å¼
  - å¤„ç† `HumanMessage`, `AIMessage`, `ToolMessage`
  - é˜²å¾¡æ€§ ID æ£€æŸ¥: `msg.id and msg.id` é¿å… null

## ğŸŒŠ æµå¼è¾“å‡º

### 7. SSE (Server-Sent Events) æµå¼åè®®
- âœ… **è‡ªå®šä¹‰äº‹ä»¶ç±»å‹**
  - `token`: æµå¼è¾“å‡ºæ–‡æœ¬ token
  - `status`: èŠ‚ç‚¹æ‰§è¡ŒçŠ¶æ€ (`retrieve`, `generate`, etc.)
  - `interrupt`: HITL ä¸­æ–­è¯·æ±‚ (æºå¸¦å®¡æ ¸ä¸Šä¸‹æ–‡)
  - `done`: æµç»“æŸ
  - `error`: é”™è¯¯ä¿¡æ¯
- âœ… **èŠ‚ç‚¹çº§æµå¼è¿‡æ»¤**
  - è¿½è¸ª `current_node` å˜é‡
  - åªæµå¼è¾“å‡º `generate` èŠ‚ç‚¹çš„ LLM å†…å®¹
  - è¿‡æ»¤å†…éƒ¨ç»“æ„åŒ–è¾“å‡º (`grade_documents`, `transform_query`)
  - é˜²æ­¢ JSON fragments æ³„éœ²åˆ°å‰ç«¯
- âœ… **Interrupt ä¸Šä¸‹æ–‡ä¼ é€’**
  - ä» `state.tasks[].interrupts[0].value` æå–ä¸Šä¸‹æ–‡
  - é€šè¿‡ SSE `context` å­—æ®µä¼ é€’
  - å‰ç«¯ä¼ªè£…æˆ `tool_calls` è§¦å‘å®¡æ ¸ UI

## ğŸ¨ å‰ç«¯ç•Œé¢

### 8. Next.js 15 + React ç°ä»£åŒ– UI
- âœ… **èŠå¤©ç•Œé¢ç»„ä»¶**
  - `Thread.tsx`: ä¸»å¯¹è¯å®¹å™¨,æ”¯æŒæ»šåŠ¨åŒºåŸŸ
  - `MessageList.tsx`: æ¶ˆæ¯åˆ—è¡¨æ¸²æŸ“
  - `MessageInput.tsx`: è¾“å…¥æ¡† + é™„ä»¶ä¸Šä¼ 
  - `MainLayout.tsx`: å…¨å±€å¸ƒå±€ (ä¾§è¾¹æ  + ä¸»åŒºåŸŸ)
- âœ… **å®æ—¶æµå¼æ¸²æŸ“**
  - `useChatThread` Hook ç®¡ç† SSE è¿æ¥
  - `EventSource` ç›‘å¬ `message`, `done`, `error` äº‹ä»¶
  - ç´¯ç§¯å¼è¿½åŠ : ç›¸åŒ ID çš„æ¶ˆæ¯å†…å®¹å åŠ 
  - React Query ç¼“å­˜ç®¡ç† (`queryKey: ["messages", threadId]`)
- âœ… **Tool Call å®¡æ ¸ UI**
  - æ£€æµ‹ `tool_calls` å¹¶æ¸²æŸ“ `human_review` å¡ç‰‡
  - æ˜¾ç¤ºå®¡æ ¸ä¸Šä¸‹æ–‡: é—®é¢˜ + æ£€ç´¢æ–‡æ¡£æ‘˜è¦
  - Allow/Deny æŒ‰é’®è°ƒç”¨ `/api/agent/stream?allowTool=allow|deny`
  - Deny åæ˜¾ç¤ºå‰ç¼€: `âœ–ï¸ å·²æ‹’ç»å®¡æ ¸ã€‚é‡æ–°æ£€ç´¢åçš„å›ç­”ï¼š`
- âœ… **é™„ä»¶å¤„ç†**
  - ä¸Šä¼ æ—¶è°ƒç”¨ `/upload/attachment` è§£ææ–‡æœ¬
  - å†…å®¹è¿½åŠ åˆ° `question` å­—æ®µ (`--- Attachments ---`)
  - æ”¯æŒå¤šé™„ä»¶åŒæ—¶ä¸Šä¼ 

## ğŸ”§ åç«¯ API

### 9. FastAPI å¼‚æ­¥æœåŠ¡
- âœ… **æ ¸å¿ƒå¯¹è¯ç«¯ç‚¹**
  - `POST /chat/stream`: ä¸»å¯¹è¯æµå¼æ¥å£ (æ”¯æŒ HITL)
  - `POST /chat/supervisor`: Supervisor å¤šæ™ºèƒ½ä½“æ¥å£
  - `POST /chat/approve`: å®¡æ‰¹æ¢å¤æ‰§è¡Œ (`Command(resume=...)`)
  - `POST /chat/state`: è·å–å½“å‰çŠ¶æ€ (è°ƒè¯•ç”¨)
- âœ… **çŸ¥è¯†åº“ç«¯ç‚¹**
  - `GET /knowledge/list`: åˆ—å‡ºæ–‡æ¡£
  - `POST /upload/knowledge`: ä¸Šä¼ åˆ°çŸ¥è¯†åº“
  - `DELETE /knowledge/{doc_id}`: åˆ é™¤æ–‡æ¡£
  - `POST /upload/attachment`: ä¸´æ—¶é™„ä»¶è§£æ
  - `POST /upload`: Legacy ç«¯ç‚¹ (è½¬å‘åˆ° attachment)
- âœ… **çº¿ç¨‹ç®¡ç†ç«¯ç‚¹**
  - `GET /threads`: åˆ—å‡ºä¼šè¯
  - `POST /threads`: åˆ›å»ºä¼šè¯
  - `DELETE /threads`: åˆ é™¤ä¼šè¯
  - `PATCH /threads`: é‡å‘½åä¼šè¯
  - `GET /history/{thread_id}`: è·å–å†å²
- âœ… **å¥åº·æ£€æŸ¥**
  - `GET /health`: ç®€å•å¥åº·æ£€æŸ¥ (`{"status": "ok"}`)

## ğŸ›¡ï¸ é”™è¯¯å¤„ç†ä¸é˜²å¾¡

### 10. ç”Ÿäº§çº§é²æ£’æ€§
- âœ… **æ— é™å¾ªç¯é˜²æŠ¤**
  - `retry_count` æœºåˆ¶ (æœ€å¤§3æ¬¡é‡è¯•)
  - è¶…è¿‡é™åˆ¶åå¼ºåˆ¶è¿›å…¥ Fallback ç”Ÿæˆ
  - åº”ç”¨äº: `should_generate`, `check_hallucination_router`
- âœ… **Graceful Degradation**
  - BM25 åº“æœªå®‰è£…æ—¶è‡ªåŠ¨è·³è¿‡é‡æ’åº
  - æ–‡æ¡£åŠ è½½å¤±è´¥æ—¶è¿”å›å‹å¥½é”™è¯¯
  - å†å²è®°å½•ä¸ºç©ºæ—¶è¿”å› `[]` è€Œé 500 é”™è¯¯
- âœ… **CORS é…ç½®**
  - å…è®¸ `localhost:3000/3001/3002` è·¨åŸŸ
  - é€šé…ç¬¦ `*` ç”¨äºå¼€å‘ç¯å¢ƒ
  - æ”¯æŒ Credentials
- âœ… **è¿æ¥æ± ç®¡ç†**
  - `AsyncSqliteSaver.from_conn_string()` ä½¿ç”¨ async context manager
  - è‡ªåŠ¨å…³é—­æ•°æ®åº“è¿æ¥,é˜²æ­¢æ³„æ¼
  - `aiosqlite` å¼‚æ­¥æ“ä½œé¿å…é˜»å¡

## ğŸ“Š æ•°æ®æŒä¹…åŒ–

### 11. ä¸‰å±‚å­˜å‚¨æ¶æ„
- **Checkpoints (çŸ­æœŸè®°å¿†)** - `checkpoints.sqlite`
  - å­˜å‚¨å¯¹è¯å†å² (`messages`)
  - å­˜å‚¨ LangGraph çŠ¶æ€å¿«ç…§
  - æ”¯æŒä¼šè¯æ¢å¤
- **Store (é•¿æœŸè®°å¿†)** - `data/user_preferences.db`
  - å­˜å‚¨ç”¨æˆ·åå¥½è§„åˆ™
  - Namespace éš”ç¦» (`marketing_preferences`)
  - è·¨ä¼šè¯å…±äº«
- **Knowledge Base (çŸ¥è¯†åº“)** - `data/knowledge.db` + `chroma_db/`
  - SQLite å­˜å‚¨æ–‡ä»¶å…ƒæ•°æ®
  - ChromaDB å­˜å‚¨å‘é‡ç´¢å¼•
  - ç£ç›˜ä¿å­˜åŸå§‹æ–‡ä»¶ (`data/uploads/`)

## ğŸ›ï¸ é…ç½®ç®¡ç†

### 12. ç¯å¢ƒé…ç½®
- âœ… **LLM é…ç½®**
  - ä½¿ç”¨ DeepSeek (OpenAI Compatible)
  - é…ç½®æ–‡ä»¶: `src/agents/marketing/llm.py`
  - æ”¯æŒåˆ‡æ¢ `base_url` å’Œ `model_name`
- âœ… **Embeddings é…ç½®**
  - Aliyun/OpenAI Compatible API
  - Model: `text-embedding-v2`
  - ç¦ç”¨é•¿åº¦æ£€æŸ¥: `check_embedding_ctx_length=False`
- âœ… **æ•°æ®åº“è·¯å¾„**
  - Checkpoints: `checkpoints.sqlite`
  - Store: `data/user_preferences.db`
  - Knowledge: `data/knowledge.db`
  - ChromaDB: `./chroma_db/`

## ğŸš€ è¿è¡Œä¸éƒ¨ç½²

### 13. å¯åŠ¨è„šæœ¬
- âœ… **åç«¯å¯åŠ¨**
  - `python -m src.server` æˆ– `uvicorn src.server:app --port 8002 --reload`
  - è‡ªåŠ¨åˆå§‹åŒ– SQLite æ•°æ®åº“
  - çƒ­é‡è½½æ”¯æŒ (`reload=True`)
- âœ… **å‰ç«¯å¯åŠ¨**
  - `npm run dev` (Next.js å¼€å‘æœåŠ¡å™¨)
  - é»˜è®¤ç«¯å£: 3000
  - API ä»£ç†: `/api/agent/*` â†’ `http://localhost:8002`

## ğŸ“ˆ å·²ä¿®å¤çš„é‡å¤§é—®é¢˜

### 14. æŠ€æœ¯å€ºåŠ¡æ¸…ç† (æœ¬æ¬¡ä¼šè¯)
- âœ… **Fix A: Store æŒä¹…åŒ–è¿ç§»**
  - ä» `InMemoryStore` è¿ç§»åˆ° `AsyncSQLiteStore`
  - å®ç°å®Œæ•´ `BaseStore` æ¥å£ (å« `abatch`, `batch`)
  - æ·»åŠ æ—¶é—´æˆ³ (`created_at`, `updated_at`)
- âœ… **Fix B: Messages æ ¼å¼ä¿®æ­£**
  - ä»é”™è¯¯çš„ tuple æ ¼å¼ `("user", question)` æ”¹ä¸º `HumanMessage(content=question)`
  - ä¿®å¤å†å²è®°å½•æ˜¾ç¤ºé—®é¢˜
- âœ… **Fix C: é€’å½’é™åˆ¶é˜²æŠ¤**
  - æ·»åŠ  `retry_count` + `max_retries=3`
  - Fallback æ¨¡å¼å¤„ç†éè¥é”€é—®é¢˜ ("ä½ æ˜¯è°")
- âœ… **Fix D: JSON Fragments æ³„éœ²**
  - æ·»åŠ  `current_node` è¿½è¸ª
  - åªæµå¼è¾“å‡º `generate` èŠ‚ç‚¹å†…å®¹
- âœ… **Fix E: HITL ä¸Šä¸‹æ–‡ä¼ é€’**
  - ä» `state.tasks[].interrupts[0].value` æå–
  - é€šè¿‡ SSE `context` å­—æ®µä¼ é€’
  - å‰ç«¯æ˜¾ç¤ºåœ¨ `tool_calls.args`
- âœ… **Fix F: Deny æ— é™å¾ªç¯**
  - ä½¿ç”¨æ¡ä»¶è·¯ç”±: `with_hitl=False` æ—¶è·³è¿‡ `human_approval`
  - Deny åç¦ç”¨ HITL å¹¶é‡æ–°æ£€ç´¢
- âœ… **Fix G: Deny æ¶ˆæ¯ä¸æŒä¹…åŒ–**
  - ç¡®ä¿ `/chat/approve` åœ¨ Deny æ—¶ä¹Ÿè¿”å› `generation`
  - å‰ç«¯æ·»åŠ  `âœ–ï¸ å·²æ‹’ç»å®¡æ ¸` å‰ç¼€

## ğŸ“ å¾…ä¼˜åŒ–åŠŸèƒ½ (æœªæ¥è®¡åˆ’)

### 15. æ½œåœ¨å¢å¼ºç‚¹
- â³ **Cross-Encoder Reranking** (å‚è€ƒ `hadywalied/Total_RAG`)
  - ä½¿ç”¨ Sentence Transformers è¿›è¡ŒäºŒæ¬¡ç²¾æ’
  - æå‡æ£€ç´¢å‡†ç¡®ç‡ 10-20%
- â³ **Web Search é›†æˆ** (å‚è€ƒ CRAG æ¨¡å¼)
  - å½“çŸ¥è¯†åº“æ— ç›¸å…³æ–‡æ¡£æ—¶è§¦å‘ Tavily/DuckDuckGo Search
  - æ‰©å±•ä¿¡æ¯æ¥æº
- â³ **æ›´æ·±åº¦çš„ Reflection**
  - è‡ªåŠ¨åˆ†æç”¨æˆ·å¯¹è¯é£æ ¼ (æ­£å¼/éšæ„)
  - ç”Ÿæˆ"ç”¨æˆ·ç”»åƒ" (è¡Œä¸šã€è§’è‰²ã€åå¥½)
- â³ **å¤šæ¨¡æ€æ”¯æŒ**
  - OCR è§£æå›¾ç‰‡å‹ PDF
  - æ”¯æŒ PPT/Excel æ·±åº¦è§£æ
- â³ **Multi-Agent æ‰©å±•**
  - æ·»åŠ "æ•°æ®åˆ†æå¸ˆ" Agent (æ”¯æŒ Python Code Execution)
  - æ·»åŠ "å†…å®¹åˆ›ä½œè€…" Agent (ç”Ÿæˆè¥é”€æ–‡æ¡ˆ)

## ğŸ‰ æ€»ç»“

æœ¬é¡¹ç›®å·²å®ç° 90+ ä¸ªç”Ÿäº§çº§åŠŸèƒ½,æ¶µç›–:
- âœ… å®Œæ•´çš„ CRAG å·¥ä½œæµ (æ£€ç´¢ â†’ è¯„åˆ† â†’ ç”Ÿæˆ â†’ åæ€)
- âœ… HITL äººæœºåä½œ (ä¸­æ–­ â†’ å®¡æ ¸ â†’ æ¢å¤)
- âœ… Hybrid Search (å‘é‡ + BM25 é‡æ’åº)
- âœ… é•¿æœŸè®°å¿†å­¦ä¹  (è·¨ä¼šè¯ç”¨æˆ·åå¥½)
- âœ… å¤šæ™ºèƒ½ä½“è°ƒåº¦ (Supervisor æ¨¡å¼)
- âœ… æµå¼ SSE è¾“å‡º (èŠ‚ç‚¹çº§è¿‡æ»¤)
- âœ… çŸ¥è¯†åº“ç®¡ç† (ä¸Šä¼ /åˆ é™¤/åˆ—è¡¨)
- âœ… ä¼šè¯æŒä¹…åŒ– (Checkpoint + SQLite)
- âœ… é˜²å¾¡æ€§ç¼–ç¨‹ (é‡è¯•é™åˆ¶ + Fallback)

**æŠ€æœ¯æ ˆæˆç†Ÿåº¦:**
- ğŸŸ¢ **åç«¯**: LangGraph + FastAPI + ChromaDB (ç”Ÿäº§å¯ç”¨)
- ğŸŸ¢ **å‰ç«¯**: Next.js 15 + React Query + SSE (ç°ä»£åŒ–)
- ğŸŸ¢ **æ•°æ®**: ä¸‰å±‚å­˜å‚¨æ¶æ„æ¸…æ™° (Checkpoint/Store/Knowledge)
- ğŸŸ¢ **RAG**: Agentic RAG (CRAG + Self-RAG) ç³»ç»Ÿ

**ä¸ GitHub ä¼˜è´¨ä»“åº“çš„å¯¹æ¯”:**
- æœ¬é¡¹ç›®å·²è¶…è¶Š å¤§å¤šæ•° CRAG ç¤ºä¾‹ä»“åº“ (å®Œæ•´å®ç° + HITL + Learning)
- æœ¬é¡¹ç›®å·²é›†æˆ `agent-service-toolkit` çš„ Supervisor æ¨¡å¼
- æœ¬é¡¹ç›®å·²å¤ç”¨ `Agentic-RAG-Ollama` çš„æ ¸å¿ƒæ¶æ„å¹¶é€‚é…ä¸ºç”Ÿäº§çº§.